library(ggplot2)
library(gstat)
library(sp)
library(maptools)
library(dplyr)
library(tidyr)
setwd("/home/kai/Desktop/grad_school/marmic/lab_rotations/rotation_3/Spiekeroog_biogeo/week5/GMT_figure/July_rates_profile")
march_oxygen_profile <- read.csv(file = "july_rates_profile.csv",header = TRUE)
march_oxygen_profile_test <- march_oxygen_profile #may not need to duplicate
min_x <- min(march_oxygen_profile_test$x)
max_x <- max(march_oxygen_profile_test$x) - min_x
march_oxygen_profile  <- march_oxygen_profile %>% mutate(x= x - min_x )
march_oxygen_profile_test <- mutate(march_oxygen_profile_test, x= x-min_x )
min_x <- 0
min_y <- min(march_oxygen_profile_test$y) - 0.1
max_y <- max(march_oxygen_profile_test$y) + 0.1
top <- filter(march_oxygen_profile_test, depth ==10)
loess_top <- loess(y ~ x, data = select(top, x, y))
bottom <- filter(march_oxygen_profile_test, depth >=60)
loess_bottom <- loess(y ~ x, data = select(bottom, x, y))
march_oxygen_profile_test <- drop_na(march_oxygen_profile_test)
x.range <- as.numeric(c(min_x, max_x))  # min/max longitude of the interpolation area
y.range <- as.numeric(c(min_y, max_y))  # min/max latitude of the interpolation area
grd <- expand.grid(x = seq(from = x.range[1], to = x.range[2], by = 0.1),
y = seq(from = y.range[1], to = y.range[2], by = 0.1))
length(seq(from = x.range[1], to = x.range[2], by = 0.01))
length(seq(from = y.range[1], to = y.range[2], by = 0.001))
coordinates(grd) <- ~x + y
gridded(grd) <- TRUE
coordinates(march_oxygen_profile_test) = ~x + y
idw <- idw(formula = rate ~ 1, locations = march_oxygen_profile_test,
newdata = grd)  # apply idw model for the data
idw.output = as.data.frame(idw)  # output is defined as a data table
names(idw.output)[1:3] <- c("long", "lat", "var1.pred")  # give names to the modelled variables
y_top_coors <- predict(loess_top, idw.output$long) + 0.1
y_bottom_coors <- predict(loess_bottom, idw.output$long) - 0.1
idw.output <- cbind(idw.output, y_top_coors,y_bottom_coors)
idw.output <- idw.output %>% filter(lat <= y_top_coors & lat >= y_bottom_coors )
p <- ggplot() +
annotate("polygon",
x= c(min(idw.output$long),min((idw.output$long)),max((idw.output$long))),
y=c(min(idw.output$lat),max(idw.output$lat),min(idw.output$lat)),
fill="#e4dcac", alpha=1) +
annotate("polygon",
x= c(min(idw.output$long),max(idw.output$long),max(idw.output$long)),
y=c(max(idw.output$lat),min(idw.output$lat),max(idw.output$lat)),
fill="#B0C0D9", alpha=1) +
ylab("Elevation (m)") +
xlab("Distance from High Water Line (m) ") +
geom_tile(data = idw.output, alpha = 1,
aes(x = long, y = lat, fill = round(var1.pred, 0))) +
scale_fill_gradientn(colours = c("blue","yellow","red") ) +
ggtitle("March Spiekeroog Oxygen Transect") +
theme(plot.title = element_text(lineheight=.8, face="bold", hjust = 0.5)) +
#+ scale_fill_gradient(low = "blue", high = "red")
geom_point(data = march_oxygen_profile, aes(x = x, y = y), shape = 0,
colour = "black") + labs(fill = expression(paste("Oxygen\nConsumption Rate (μmol l" ^"-1"*"h"^"-1"*")" )) )
p
View(idw.output)
View(march_oxygen_profile)
View(march_oxygen_profile)
setwd("/home/kai/Desktop/grad_school/marmic/lab_rotations/rotation_3/Spiekeroog_biogeo/week5/GMT_figure/July_rates_profile")
march_oxygen_profile <- read.csv(file = "july_rates_profile.csv",header = TRUE)
march_oxygen_profile_test <- march_oxygen_profile #may not need to duplicate
min_x <- min(march_oxygen_profile_test$x) +3
max_x <- max(march_oxygen_profile_test$x) - min_x
march_oxygen_profile  <- march_oxygen_profile %>% mutate(x= x - min_x )
march_oxygen_profile_test <- mutate(march_oxygen_profile_test, x= x-min_x )
View(march_oxygen_profile)
setwd("/home/kai/Desktop/grad_school/marmic/lab_rotations/rotation_3/Spiekeroog_biogeo/week5/GMT_figure/July_rates_profile")
march_oxygen_profile <- read.csv(file = "july_rates_profile.csv",header = TRUE)
march_oxygen_profile_test <- march_oxygen_profile #may not need to duplicate
min_x <- min(march_oxygen_profile_test$x) -3
max_x <- max(march_oxygen_profile_test$x) - min_x
march_oxygen_profile  <- march_oxygen_profile %>% mutate(x= x - min_x )
march_oxygen_profile_test <- mutate(march_oxygen_profile_test, x= x-min_x )
min_x <- 0
min_y <- min(march_oxygen_profile_test$y) - 0.1
max_y <- max(march_oxygen_profile_test$y) + 0.1
top <- filter(march_oxygen_profile_test, depth ==10)
loess_top <- loess(y ~ x, data = select(top, x, y))
bottom <- filter(march_oxygen_profile_test, depth >=60)
loess_bottom <- loess(y ~ x, data = select(bottom, x, y))
march_oxygen_profile_test <- drop_na(march_oxygen_profile_test)
x.range <- as.numeric(c(min_x, max_x))  # min/max longitude of the interpolation area
y.range <- as.numeric(c(min_y, max_y))  # min/max latitude of the interpolation area
grd <- expand.grid(x = seq(from = x.range[1], to = x.range[2], by = 0.1),
y = seq(from = y.range[1], to = y.range[2], by = 0.1))
length(seq(from = x.range[1], to = x.range[2], by = 0.01))
length(seq(from = y.range[1], to = y.range[2], by = 0.001))
coordinates(grd) <- ~x + y
gridded(grd) <- TRUE
coordinates(march_oxygen_profile_test) = ~x + y
idw <- idw(formula = rate ~ 1, locations = march_oxygen_profile_test,
newdata = grd)  # apply idw model for the data
idw.output = as.data.frame(idw)  # output is defined as a data table
names(idw.output)[1:3] <- c("long", "lat", "var1.pred")  # give names to the modelled variables
y_top_coors <- predict(loess_top, idw.output$long) + 0.1
y_bottom_coors <- predict(loess_bottom, idw.output$long) - 0.1
idw.output <- cbind(idw.output, y_top_coors,y_bottom_coors)
idw.output <- idw.output %>% filter(lat <= y_top_coors & lat >= y_bottom_coors )
p <- ggplot() +
annotate("polygon",
x= c(min(idw.output$long),min((idw.output$long)),max((idw.output$long))),
y=c(min(idw.output$lat),max(idw.output$lat),min(idw.output$lat)),
fill="#e4dcac", alpha=1) +
annotate("polygon",
x= c(min(idw.output$long),max(idw.output$long),max(idw.output$long)),
y=c(max(idw.output$lat),min(idw.output$lat),max(idw.output$lat)),
fill="#B0C0D9", alpha=1) +
ylab("Elevation (m)") +
xlab("Distance from High Water Line (m) ") +
geom_tile(data = idw.output, alpha = 1,
aes(x = long, y = lat, fill = round(var1.pred, 0))) +
scale_fill_gradientn(colours = c("blue","yellow","red") ) +
ggtitle("March Spiekeroog Oxygen Transect") +
theme(plot.title = element_text(lineheight=.8, face="bold", hjust = 0.5)) +
#+ scale_fill_gradient(low = "blue", high = "red")
geom_point(data = march_oxygen_profile, aes(x = x, y = y), shape = 0,
colour = "black") + labs(fill = expression(paste("Oxygen\nConsumption Rate (μmol l" ^"-1"*"h"^"-1"*")" )) )
p
setwd("/home/kai/Desktop/grad_school/marmic/lab_rotations/rotation_3/Spiekeroog_biogeo/week5/GMT_figure/July_rates_profile")
march_oxygen_profile <- read.csv(file = "july_rates_profile.csv",header = TRUE)
march_oxygen_profile_test <- march_oxygen_profile #may not need to duplicate
min_x <- min(march_oxygen_profile_test$x) -3
max_x <- max(march_oxygen_profile_test$x) - min_x
march_oxygen_profile  <- march_oxygen_profile %>% mutate(x= x - min_x )
march_oxygen_profile_test <- mutate(march_oxygen_profile_test, x= x-min_x )
min_x <- 0
setwd("/home/kai/Desktop/grad_school/marmic/lab_rotations/rotation_3/Spiekeroog_biogeo/week5/GMT_figure/July_rates_profile")
march_oxygen_profile <- read.csv(file = "july_rates_profile.csv",header = TRUE)
march_oxygen_profile_test <- march_oxygen_profile #may not need to duplicate
min_x <- min(march_oxygen_profile_test$x) -3
max_x <- max(march_oxygen_profile_test$x) - min_x +3
march_oxygen_profile  <- march_oxygen_profile %>% mutate(x= x - min_x )
march_oxygen_profile_test <- mutate(march_oxygen_profile_test, x= x-min_x )
min_x <- 0
min_y <- min(march_oxygen_profile_test$y) - 0.1
max_y <- max(march_oxygen_profile_test$y) + 0.1
top <- filter(march_oxygen_profile_test, depth ==10)
loess_top <- loess(y ~ x, data = select(top, x, y))
bottom <- filter(march_oxygen_profile_test, depth >=60)
loess_bottom <- loess(y ~ x, data = select(bottom, x, y))
march_oxygen_profile_test <- drop_na(march_oxygen_profile_test)
x.range <- as.numeric(c(min_x, max_x))  # min/max longitude of the interpolation area
y.range <- as.numeric(c(min_y, max_y))  # min/max latitude of the interpolation area
grd <- expand.grid(x = seq(from = x.range[1], to = x.range[2], by = 0.1),
y = seq(from = y.range[1], to = y.range[2], by = 0.1))
length(seq(from = x.range[1], to = x.range[2], by = 0.01))
length(seq(from = y.range[1], to = y.range[2], by = 0.001))
coordinates(grd) <- ~x + y
gridded(grd) <- TRUE
coordinates(march_oxygen_profile_test) = ~x + y
idw <- idw(formula = rate ~ 1, locations = march_oxygen_profile_test,
newdata = grd)  # apply idw model for the data
idw.output = as.data.frame(idw)  # output is defined as a data table
names(idw.output)[1:3] <- c("long", "lat", "var1.pred")  # give names to the modelled variables
y_top_coors <- predict(loess_top, idw.output$long) + 0.1
y_bottom_coors <- predict(loess_bottom, idw.output$long) - 0.1
idw.output <- cbind(idw.output, y_top_coors,y_bottom_coors)
idw.output <- idw.output %>% filter(lat <= y_top_coors & lat >= y_bottom_coors )
p <- ggplot() +
annotate("polygon",
x= c(min(idw.output$long),min((idw.output$long)),max((idw.output$long))),
y=c(min(idw.output$lat),max(idw.output$lat),min(idw.output$lat)),
fill="#e4dcac", alpha=1) +
annotate("polygon",
x= c(min(idw.output$long),max(idw.output$long),max(idw.output$long)),
y=c(max(idw.output$lat),min(idw.output$lat),max(idw.output$lat)),
fill="#B0C0D9", alpha=1) +
ylab("Elevation (m)") +
xlab("Distance from High Water Line (m) ") +
geom_tile(data = idw.output, alpha = 1,
aes(x = long, y = lat, fill = round(var1.pred, 0))) +
scale_fill_gradientn(colours = c("blue","yellow","red") ) +
ggtitle("March Spiekeroog Oxygen Transect") +
theme(plot.title = element_text(lineheight=.8, face="bold", hjust = 0.5)) +
#+ scale_fill_gradient(low = "blue", high = "red")
geom_point(data = march_oxygen_profile, aes(x = x, y = y), shape = 0,
colour = "black") + labs(fill = expression(paste("Oxygen\nConsumption Rate (μmol l" ^"-1"*"h"^"-1"*")" )) )
p
setwd("/home/kai/Desktop/grad_school/marmic/lab_rotations/rotation_3/Spiekeroog_biogeo/week5/GMT_figure/July_rates_profile")
march_oxygen_profile <- read.csv(file = "july_rates_profile.csv",header = TRUE)
march_oxygen_profile_test <- march_oxygen_profile #may not need to duplicate
min_x <- min(march_oxygen_profile_test$x)
max_x <- max(march_oxygen_profile_test$x) - min_x
march_oxygen_profile  <- march_oxygen_profile %>% mutate(x= x - min_x )
march_oxygen_profile_test <- mutate(march_oxygen_profile_test, x= x-min_x )
min_x <- 0
min_y <- min(march_oxygen_profile_test$y) - 0.1
max_y <- max(march_oxygen_profile_test$y) + 0.1
top <- filter(march_oxygen_profile_test, depth ==10)
loess_top <- loess(y ~ x, data = select(top, x, y))
bottom <- filter(march_oxygen_profile_test, depth >=60)
loess_bottom <- loess(y ~ x, data = select(bottom, x, y))
march_oxygen_profile_test <- drop_na(march_oxygen_profile_test)
x.range <- as.numeric(c(min_x, max_x))  # min/max longitude of the interpolation area
y.range <- as.numeric(c(min_y, max_y))  # min/max latitude of the interpolation area
grd <- expand.grid(x = seq(from = x.range[1], to = x.range[2], by = 0.1),
y = seq(from = y.range[1], to = y.range[2], by = 0.1))
length(seq(from = x.range[1], to = x.range[2], by = 0.01))
length(seq(from = y.range[1], to = y.range[2], by = 0.001))
coordinates(grd) <- ~x + y
gridded(grd) <- TRUE
coordinates(march_oxygen_profile_test) = ~x + y
idw <- idw(formula = rate ~ 1, locations = march_oxygen_profile_test,
newdata = grd)  # apply idw model for the data
idw.output = as.data.frame(idw)  # output is defined as a data table
names(idw.output)[1:3] <- c("long", "lat", "var1.pred")  # give names to the modelled variables
y_top_coors <- predict(loess_top, idw.output$long) + 0.1
y_bottom_coors <- predict(loess_bottom, idw.output$long) - 0.1
idw.output <- cbind(idw.output, y_top_coors,y_bottom_coors)
idw.output <- idw.output %>% filter(lat <= y_top_coors & lat >= y_bottom_coors )
p <- ggplot() +
annotate("polygon",
x= c(min(idw.output$long),min((idw.output$long)),max((idw.output$long))),
y=c(min(idw.output$lat),max(idw.output$lat),min(idw.output$lat)),
fill="#e4dcac", alpha=1) +
annotate("polygon",
x= c(min(idw.output$long),max(idw.output$long),max(idw.output$long)),
y=c(max(idw.output$lat),min(idw.output$lat),max(idw.output$lat)),
fill="#B0C0D9", alpha=1) +
ylab("Elevation (m)") +
xlab("Distance from High Water Line (m) ") +
geom_tile(data = idw.output, alpha = 1,
aes(x = long, y = lat, fill = round(var1.pred, 0))) +
scale_fill_gradientn(colours = c("blue","yellow","red") ) +
ggtitle("March Spiekeroog Oxygen Transect") +
theme(plot.title = element_text(lineheight=.8, face="bold", hjust = 0.5)) +
#+ scale_fill_gradient(low = "blue", high = "red")
geom_point(data = march_oxygen_profile, aes(x = x, y = y), shape = 0,
colour = "black") + labs(fill = expression(paste("Oxygen\nConsumption Rate (μmol l" ^"-1"*"h"^"-1"*")" )) )
p
library(ggplot2)
library(gstat)
library(sp)
library(maptools)
library(dplyr)
library(tidyr)
setwd("/home/kai/Desktop/grad_school/marmic/lab_rotations/rotation_3/Spiekeroog_biogeo/week5/GMT_figure/July_rates_profile")
march_oxygen_profile <- read.csv(file = "july_rates_profile.csv",header = TRUE)
march_oxygen_profile_test <- march_oxygen_profile #may not need to duplicate
min_x <- min(march_oxygen_profile_test$x)
max_x <- max(march_oxygen_profile_test$x) - min_x
march_oxygen_profile  <- march_oxygen_profile %>% mutate(x= x - min_x )
march_oxygen_profile_test <- mutate(march_oxygen_profile_test, x= x-min_x )
min_x <- min_x -3
max_x <- max_x +3
setwd("/home/kai/Desktop/grad_school/marmic/lab_rotations/rotation_3/Spiekeroog_biogeo/week5/GMT_figure/July_rates_profile")
march_oxygen_profile <- read.csv(file = "july_rates_profile.csv",header = TRUE)
march_oxygen_profile_test <- march_oxygen_profile #may not need to duplicate
min_x <- min(march_oxygen_profile_test$x)
max_x <- max(march_oxygen_profile_test$x) - min_x
march_oxygen_profile  <- march_oxygen_profile %>% mutate(x= x - min_x )
march_oxygen_profile_test <- mutate(march_oxygen_profile_test, x= x-min_x )
min_x <- -3
max_x <- max_x +3
min_y <- min(march_oxygen_profile_test$y) - 0.1
max_y <- max(march_oxygen_profile_test$y) + 0.1
top <- filter(march_oxygen_profile_test, depth ==10)
loess_top <- loess(y ~ x, data = select(top, x, y))
bottom <- filter(march_oxygen_profile_test, depth >=60)
loess_bottom <- loess(y ~ x, data = select(bottom, x, y))
march_oxygen_profile_test <- drop_na(march_oxygen_profile_test)
x.range <- as.numeric(c(min_x, max_x))  # min/max longitude of the interpolation area
y.range <- as.numeric(c(min_y, max_y))  # min/max latitude of the interpolation area
grd <- expand.grid(x = seq(from = x.range[1], to = x.range[2], by = 0.1),
y = seq(from = y.range[1], to = y.range[2], by = 0.1))
length(seq(from = x.range[1], to = x.range[2], by = 0.01))
length(seq(from = y.range[1], to = y.range[2], by = 0.001))
coordinates(grd) <- ~x + y
gridded(grd) <- TRUE
coordinates(march_oxygen_profile_test) = ~x + y
idw <- idw(formula = rate ~ 1, locations = march_oxygen_profile_test,
newdata = grd)  # apply idw model for the data
idw.output = as.data.frame(idw)  # output is defined as a data table
names(idw.output)[1:3] <- c("long", "lat", "var1.pred")  # give names to the modelled variables
y_top_coors <- predict(loess_top, idw.output$long) + 0.1
y_bottom_coors <- predict(loess_bottom, idw.output$long) - 0.1
idw.output <- cbind(idw.output, y_top_coors,y_bottom_coors)
idw.output <- idw.output %>% filter(lat <= y_top_coors & lat >= y_bottom_coors )
p <- ggplot() +
annotate("polygon",
x= c(min(idw.output$long),min((idw.output$long)),max((idw.output$long))),
y=c(min(idw.output$lat),max(idw.output$lat),min(idw.output$lat)),
fill="#e4dcac", alpha=1) +
annotate("polygon",
x= c(min(idw.output$long),max(idw.output$long),max(idw.output$long)),
y=c(max(idw.output$lat),min(idw.output$lat),max(idw.output$lat)),
fill="#B0C0D9", alpha=1) +
ylab("Elevation (m)") +
xlab("Distance from High Water Line (m) ") +
geom_tile(data = idw.output, alpha = 1,
aes(x = long, y = lat, fill = round(var1.pred, 0))) +
scale_fill_gradientn(colours = c("blue","yellow","red") ) +
ggtitle("March Spiekeroog Oxygen Transect") +
theme(plot.title = element_text(lineheight=.8, face="bold", hjust = 0.5)) +
#+ scale_fill_gradient(low = "blue", high = "red")
geom_point(data = march_oxygen_profile, aes(x = x, y = y), shape = 0,
colour = "black") + labs(fill = expression(paste("Oxygen\nConsumption Rate (μmol l" ^"-1"*"h"^"-1"*")" )) )
p
setwd("/home/kai/Desktop/grad_school/marmic/lab_rotations/rotation_3/Spiekeroog_biogeo/week5/GMT_figure/July_rates_profile")
march_oxygen_profile <- read.csv(file = "july_rates_profile.csv",header = TRUE)
march_oxygen_profile_test <- march_oxygen_profile #may not need to duplicate
min_x <- min(march_oxygen_profile_test$x)
max_x <- max(march_oxygen_profile_test$x) - min_x
march_oxygen_profile  <- march_oxygen_profile %>% mutate(x= x - min_x +3 )
march_oxygen_profile_test <- mutate(march_oxygen_profile_test, x= x-min_x )
min_x <- -3
max_x <- max_x +3
min_y <- min(march_oxygen_profile_test$y) - 0.1
max_y <- max(march_oxygen_profile_test$y) + 0.1
top <- filter(march_oxygen_profile_test, depth ==10)
loess_top <- loess(y ~ x, data = select(top, x, y))
bottom <- filter(march_oxygen_profile_test, depth >=60)
loess_bottom <- loess(y ~ x, data = select(bottom, x, y))
march_oxygen_profile_test <- drop_na(march_oxygen_profile_test)
x.range <- as.numeric(c(min_x, max_x))  # min/max longitude of the interpolation area
y.range <- as.numeric(c(min_y, max_y))  # min/max latitude of the interpolation area
grd <- expand.grid(x = seq(from = x.range[1], to = x.range[2], by = 0.1),
y = seq(from = y.range[1], to = y.range[2], by = 0.1))
length(seq(from = x.range[1], to = x.range[2], by = 0.01))
length(seq(from = y.range[1], to = y.range[2], by = 0.001))
coordinates(grd) <- ~x + y
gridded(grd) <- TRUE
coordinates(march_oxygen_profile_test) = ~x + y
idw <- idw(formula = rate ~ 1, locations = march_oxygen_profile_test,
newdata = grd)  # apply idw model for the data
idw.output = as.data.frame(idw)  # output is defined as a data table
names(idw.output)[1:3] <- c("long", "lat", "var1.pred")  # give names to the modelled variables
y_top_coors <- predict(loess_top, idw.output$long) + 0.1
y_bottom_coors <- predict(loess_bottom, idw.output$long) - 0.1
idw.output <- cbind(idw.output, y_top_coors,y_bottom_coors)
idw.output <- idw.output %>% filter(lat <= y_top_coors & lat >= y_bottom_coors )
p <- ggplot() +
annotate("polygon",
x= c(min(idw.output$long),min((idw.output$long)),max((idw.output$long))),
y=c(min(idw.output$lat),max(idw.output$lat),min(idw.output$lat)),
fill="#e4dcac", alpha=1) +
annotate("polygon",
x= c(min(idw.output$long),max(idw.output$long),max(idw.output$long)),
y=c(max(idw.output$lat),min(idw.output$lat),max(idw.output$lat)),
fill="#B0C0D9", alpha=1) +
ylab("Elevation (m)") +
xlab("Distance from High Water Line (m) ") +
geom_tile(data = idw.output, alpha = 1,
aes(x = long, y = lat, fill = round(var1.pred, 0))) +
scale_fill_gradientn(colours = c("blue","yellow","red") ) +
ggtitle("March Spiekeroog Oxygen Transect") +
theme(plot.title = element_text(lineheight=.8, face="bold", hjust = 0.5)) +
#+ scale_fill_gradient(low = "blue", high = "red")
geom_point(data = march_oxygen_profile, aes(x = x, y = y), shape = 0,
colour = "black") + labs(fill = expression(paste("Oxygen\nConsumption Rate (μmol l" ^"-1"*"h"^"-1"*")" )) )
p
march_oxygen_profile <- read.csv(file = "july_rates_profile.csv",header = TRUE)
march_oxygen_profile_test <- march_oxygen_profile #may not need to duplicate
min_x <- min(march_oxygen_profile_test$x)
max_x <- max(march_oxygen_profile_test$x) - min_x +3
march_oxygen_profile  <- march_oxygen_profile %>% mutate(x= x - min_x -3 )
march_oxygen_profile_test <- mutate(march_oxygen_profile_test, x= x-min_x -3)
min_x <- -3
min_y <- min(march_oxygen_profile_test$y) - 0.1
max_y <- max(march_oxygen_profile_test$y) + 0.1
top <- filter(march_oxygen_profile_test, depth ==10)
loess_top <- loess(y ~ x, data = select(top, x, y))
bottom <- filter(march_oxygen_profile_test, depth >=60)
loess_bottom <- loess(y ~ x, data = select(bottom, x, y))
march_oxygen_profile_test <- drop_na(march_oxygen_profile_test)
x.range <- as.numeric(c(min_x, max_x))  # min/max longitude of the interpolation area
y.range <- as.numeric(c(min_y, max_y))  # min/max latitude of the interpolation area
grd <- expand.grid(x = seq(from = x.range[1], to = x.range[2], by = 0.1),
y = seq(from = y.range[1], to = y.range[2], by = 0.1))
length(seq(from = x.range[1], to = x.range[2], by = 0.01))
length(seq(from = y.range[1], to = y.range[2], by = 0.001))
coordinates(grd) <- ~x + y
gridded(grd) <- TRUE
coordinates(march_oxygen_profile_test) = ~x + y
idw <- idw(formula = rate ~ 1, locations = march_oxygen_profile_test,
newdata = grd)  # apply idw model for the data
idw.output = as.data.frame(idw)  # output is defined as a data table
names(idw.output)[1:3] <- c("long", "lat", "var1.pred")  # give names to the modelled variables
y_top_coors <- predict(loess_top, idw.output$long) + 0.1
y_bottom_coors <- predict(loess_bottom, idw.output$long) - 0.1
idw.output <- cbind(idw.output, y_top_coors,y_bottom_coors)
idw.output <- idw.output %>% filter(lat <= y_top_coors & lat >= y_bottom_coors )
p <- ggplot() +
annotate("polygon",
x= c(min(idw.output$long),min((idw.output$long)),max((idw.output$long))),
y=c(min(idw.output$lat),max(idw.output$lat),min(idw.output$lat)),
fill="#e4dcac", alpha=1) +
annotate("polygon",
x= c(min(idw.output$long),max(idw.output$long),max(idw.output$long)),
y=c(max(idw.output$lat),min(idw.output$lat),max(idw.output$lat)),
fill="#B0C0D9", alpha=1) +
ylab("Elevation (m)") +
xlab("Distance from High Water Line (m) ") +
geom_tile(data = idw.output, alpha = 1,
aes(x = long, y = lat, fill = round(var1.pred, 0))) +
scale_fill_gradientn(colours = c("blue","yellow","red") ) +
ggtitle("March Spiekeroog Oxygen Transect") +
theme(plot.title = element_text(lineheight=.8, face="bold", hjust = 0.5)) +
#+ scale_fill_gradient(low = "blue", high = "red")
geom_point(data = march_oxygen_profile, aes(x = x, y = y), shape = 0,
colour = "black") + labs(fill = expression(paste("Oxygen\nConsumption Rate (μmol l" ^"-1"*"h"^"-1"*")" )) )
p
setwd("/home/kai/Desktop/grad_school/marmic/lab_rotations/rotation_3/Spiekeroog_biogeo/week5/GMT_figure/July_rates_profile")
march_oxygen_profile <- read.csv(file = "july_rates_profile.csv",header = TRUE)
march_oxygen_profile_test <- march_oxygen_profile #may not need to duplicate
min_x <- min(march_oxygen_profile_test$x)
max_x <- max(march_oxygen_profile_test$x) - min_x +3
march_oxygen_profile  <- march_oxygen_profile %>% mutate(x= x - min_x  )
march_oxygen_profile_test <- mutate(march_oxygen_profile_test, x= x-min_x )
min_x <- -3
min_y <- min(march_oxygen_profile_test$y) - 0.1
max_y <- max(march_oxygen_profile_test$y) + 0.1
top <- filter(march_oxygen_profile_test, depth ==10)
loess_top <- loess(y ~ x, data = select(top, x, y))
bottom <- filter(march_oxygen_profile_test, depth >=60)
loess_bottom <- loess(y ~ x, data = select(bottom, x, y))
march_oxygen_profile_test <- drop_na(march_oxygen_profile_test)
x.range <- as.numeric(c(min_x, max_x))  # min/max longitude of the interpolation area
y.range <- as.numeric(c(min_y, max_y))  # min/max latitude of the interpolation area
grd <- expand.grid(x = seq(from = x.range[1], to = x.range[2], by = 0.1),
y = seq(from = y.range[1], to = y.range[2], by = 0.1))
length(seq(from = x.range[1], to = x.range[2], by = 0.01))
length(seq(from = y.range[1], to = y.range[2], by = 0.001))
coordinates(grd) <- ~x + y
gridded(grd) <- TRUE
coordinates(march_oxygen_profile_test) = ~x + y
idw <- idw(formula = rate ~ 1, locations = march_oxygen_profile_test,
newdata = grd)  # apply idw model for the data
idw.output = as.data.frame(idw)  # output is defined as a data table
names(idw.output)[1:3] <- c("long", "lat", "var1.pred")  # give names to the modelled variables
y_top_coors <- predict(loess_top, idw.output$long) + 0.1
y_bottom_coors <- predict(loess_bottom, idw.output$long) - 0.1
idw.output <- cbind(idw.output, y_top_coors,y_bottom_coors)
idw.output <- idw.output %>% filter(lat <= y_top_coors & lat >= y_bottom_coors )
p <- ggplot() +
annotate("polygon",
x= c(min(idw.output$long),min((idw.output$long)),max((idw.output$long))),
y=c(min(idw.output$lat),max(idw.output$lat),min(idw.output$lat)),
fill="#e4dcac", alpha=1) +
annotate("polygon",
x= c(min(idw.output$long),max(idw.output$long),max(idw.output$long)),
y=c(max(idw.output$lat),min(idw.output$lat),max(idw.output$lat)),
fill="#B0C0D9", alpha=1) +
ylab("Elevation (m)") +
xlab("Distance from High Water Line (m) ") +
geom_tile(data = idw.output, alpha = 1,
aes(x = long, y = lat, fill = round(var1.pred, 0))) +
scale_fill_gradientn(colours = c("blue","yellow","red") ) +
ggtitle("March Spiekeroog Oxygen Transect") +
theme(plot.title = element_text(lineheight=.8, face="bold", hjust = 0.5)) +
#+ scale_fill_gradient(low = "blue", high = "red")
geom_point(data = march_oxygen_profile, aes(x = x, y = y), shape = 0,
colour = "black") + labs(fill = expression(paste("Oxygen\nConsumption Rate (μmol l" ^"-1"*"h"^"-1"*")" )) )
p
setwd("/home/kai/Desktop/grad_school/marmic/lab_rotations/rotation_3/Spiekeroog_biogeo/week5/GMT_figure/July_rates_profile")
march_oxygen_profile <- read.csv(file = "july_rates_profile.csv",header = TRUE)
march_oxygen_profile_test <- march_oxygen_profile #may not need to duplicate
min_x <- min(march_oxygen_profile_test$x)
max_x <- max(march_oxygen_profile_test$x) - min_x
march_oxygen_profile  <- march_oxygen_profile %>% mutate(x= x - min_x  )
march_oxygen_profile_test <- mutate(march_oxygen_profile_test, x= x-min_x )
min_x <- 0
min_y <- min(march_oxygen_profile_test$y) - 0.1
max_y <- max(march_oxygen_profile_test$y) + 0.1
top <- filter(march_oxygen_profile_test, depth ==10)
loess_top <- loess(y ~ x, data = select(top, x, y))
bottom <- filter(march_oxygen_profile_test, depth >=60)
loess_bottom <- loess(y ~ x, data = select(bottom, x, y))
march_oxygen_profile_test <- drop_na(march_oxygen_profile_test)
x.range <- as.numeric(c(min_x, max_x))  # min/max longitude of the interpolation area
y.range <- as.numeric(c(min_y, max_y))  # min/max latitude of the interpolation area
grd <- expand.grid(x = seq(from = x.range[1], to = x.range[2], by = 0.1),
y = seq(from = y.range[1], to = y.range[2], by = 0.1))
length(seq(from = x.range[1], to = x.range[2], by = 0.01))
length(seq(from = y.range[1], to = y.range[2], by = 0.001))
coordinates(grd) <- ~x + y
gridded(grd) <- TRUE
coordinates(march_oxygen_profile_test) = ~x + y
idw <- idw(formula = rate ~ 1, locations = march_oxygen_profile_test,
newdata = grd)  # apply idw model for the data
idw.output = as.data.frame(idw)  # output is defined as a data table
names(idw.output)[1:3] <- c("long", "lat", "var1.pred")  # give names to the modelled variables
y_top_coors <- predict(loess_top, idw.output$long) + 0.1
y_bottom_coors <- predict(loess_bottom, idw.output$long) - 0.1
idw.output <- cbind(idw.output, y_top_coors,y_bottom_coors)
idw.output <- idw.output %>% filter(lat <= y_top_coors & lat >= y_bottom_coors )
p <- ggplot() +
annotate("polygon",
x= c(min(idw.output$long),min((idw.output$long)),max((idw.output$long))),
y=c(min(idw.output$lat),max(idw.output$lat),min(idw.output$lat)),
fill="#e4dcac", alpha=1) +
annotate("polygon",
x= c(min(idw.output$long),max(idw.output$long),max(idw.output$long)),
y=c(max(idw.output$lat),min(idw.output$lat),max(idw.output$lat)),
fill="#B0C0D9", alpha=1) +
ylab("Elevation (m)") +
xlab("Distance from High Water Line (m) ") +
geom_tile(data = idw.output, alpha = 1,
aes(x = long, y = lat, fill = round(var1.pred, 0))) +
scale_fill_gradientn(colours = c("blue","yellow","red") ) +
ggtitle("March Spiekeroog Oxygen Transect") +
theme(plot.title = element_text(lineheight=.8, face="bold", hjust = 0.5)) +
#+ scale_fill_gradient(low = "blue", high = "red")
geom_point(data = march_oxygen_profile, aes(x = x, y = y), shape = 0,
colour = "black") + labs(fill = expression(paste("Oxygen\nConsumption Rate (μmol l" ^"-1"*"h"^"-1"*")" )) )
p
setwd("/home/kai/Desktop/grad_school/marmic/lab_rotations/rotation_3/Spiekeroog_biogeo/week5/GMT_figure/July_rates_profile")
march_oxygen_profile <- read.csv(file = "july_rates_profile.csv",header = TRUE)
march_oxygen_profile_test <- march_oxygen_profile #may not need to duplicate
