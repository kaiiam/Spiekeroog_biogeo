geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(data=berm_reg,se = FALSE, method = "lm") +
ggtitle("Berm") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#ecd240", "#ff8811", "#f12700", "#972e23"))
plot_low_water_line<- low_water_line %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(data= low_water_line_reg,se = FALSE, method = "lm") +
ggtitle("Low Water Line") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#ecd240", "#ff8811", "#f12700", "#972e23"))
plot(plot_beach_above_mwl)
plot(plot_lagoon)
plot(plot_berm)
plot(plot_low_water_line)
plot_beach_above_mwl<- beach_above_mwl %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(data=beach_above_mwl_reg, se = FALSE, method = "lm") +
ggtitle("Beach above Mean Water Line") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#2A1D18", "#505346", "#6D7C71", "#848C7F"))
plot_beach_above_mwl
plot_lagoon<- lagoon %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(data= lagoon_reg, se = FALSE, method = "lm") +
ggtitle("Lagoon") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#2A1D18", "#505346", "#6D7C71", "#848C7F"))
plot_lagoon
plot_lagoon<- lagoon %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(data= lagoon_reg, se = FALSE, method = "lm") +
ggtitle("Lagoon") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#a1bd02", "#889a24", "#53750e", "#385203"))
plot_lagoon
plot_lagoon<- lagoon %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(data= lagoon_reg, se = FALSE, method = "lm") +
ggtitle("Lagoon") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#d2f800", "#a1bd02", "#53750e", "#385203"))
plot_lagoon
plot_lagoon<- lagoon %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(data= lagoon_reg, se = FALSE, method = "lm") +
ggtitle("Lagoon") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#d2f800", "#a1bd02", "#53750e", "#324902"))
plot_lagoon
plot_lagoon<- lagoon %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(data= lagoon_reg, se = FALSE, method = "lm") +
ggtitle("Lagoon") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#d2f800", "#a1bd02", "#838c4e", "#324902"))
plot_lagoon
plot_lagoon<- lagoon %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(data= lagoon_reg, se = FALSE, method = "lm") +
ggtitle("Lagoon") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#d2f800", "#a1bd02", "#686b3d", "#324902"))
plot_lagoon
plot_lagoon<- lagoon %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(data= lagoon_reg, se = FALSE, method = "lm") +
ggtitle("Lagoon") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#d2f800", "#a1bd02", "#676c0e", "#324902"))
plot_lagoon
plot_lagoon<- lagoon %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(data= lagoon_reg, se = FALSE, method = "lm") +
ggtitle("Lagoon") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#d2f800", "#a1bd02", "#637635", "#324902"))
plot_lagoon
plot_lagoon<- lagoon %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(data= lagoon_reg, se = FALSE, method = "lm") +
ggtitle("Lagoon") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#d2f800", "#a1bd02", "#4e690a", "#324902"))
plot_lagoon
plot_lagoon<- lagoon %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(data= lagoon_reg, se = FALSE, method = "lm") +
ggtitle("Lagoon") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#d2f800", "#a1bd02", "#4e690a", "#2b3f01"))
plot_lagoon
plot_lagoon<- lagoon %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(data= lagoon_reg, se = FALSE, method = "lm") +
ggtitle("Lagoon") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#e9ff9b", "#d2f800", "#4e690a", "#2b3f01"))
plot_lagoon
plot_berm<- berm %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(data=berm_reg,se = FALSE, method = "lm") +
ggtitle("Berm") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#ecd240", "#ff8811", "#f12700", "#972e23"))
plot_berm
plot_lagoon<- lagoon %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(data= lagoon_reg, se = FALSE, method = "lm") +
ggtitle("Lagoon") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#ecd240", "#d2f800", "#4e690a", "#2b3f01"))
plot_lagoon
plot_lagoon<- lagoon %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(data= lagoon_reg, se = FALSE, method = "lm") +
ggtitle("Lagoon") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#B0C0D9", "#d2f800", "#4e690a", "#2b3f01"))
plot_lagoon
plot_lagoon<- lagoon %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(data= lagoon_reg, se = FALSE, method = "lm") +
ggtitle("Lagoon") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#e4dcac", "#d2f800", "#4e690a", "#2b3f01"))
plot_lagoon
plot_lagoon<- lagoon %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(data= lagoon_reg, se = FALSE, method = "lm") +
ggtitle("Lagoon") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#eee717", "#d2f800", "#4e690a", "#2b3f01"))
plot_lagoon
plot_lagoon<- lagoon %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(data= lagoon_reg, se = FALSE, method = "lm") +
ggtitle("Lagoon") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#eee717", "#d2f800", "#4e690a", "#243401"))
plot_lagoon
plot_lagoon<- lagoon %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(data= lagoon_reg, se = FALSE, method = "lm") +
ggtitle("Lagoon") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#eee717", "#d2f800", "#5c9437", "#243401"))
plot_lagoon
plot_lagoon<- lagoon %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(data= lagoon_reg, se = FALSE, method = "lm") +
ggtitle("Lagoon") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#eee717", "#d2f800", "#5c9437", "#345700"))
plot_lagoon
plot_beach_above_mwl<- beach_above_mwl %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(data=beach_above_mwl_reg, se = FALSE, method = "lm") +
ggtitle("Beach above Mean Water Line") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#eee717", "#d2f800", "#5c9437", "#345700"))
plot_lagoon<- lagoon %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(data= lagoon_reg, se = FALSE, method = "lm") +
ggtitle("Lagoon") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#eee717", "#d2f800", "#5c9437", "#345700"))
plot_berm<- berm %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(data=berm_reg,se = FALSE, method = "lm") +
ggtitle("Berm") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#eee717", "#d2f800", "#5c9437", "#345700"))
plot_low_water_line<- low_water_line %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(data= low_water_line_reg,se = FALSE, method = "lm") +
ggtitle("Low Water Line") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#eee717", "#d2f800", "#5c9437", "#345700"))
plot_low_water_line
plot(plot_beach_above_mwl)
plot(plot_lagoon)
plot(plot_berm)
plot(plot_low_water_line)
ggsave(filename = "/home/kai/Desktop/grad_school/marmic/lab_rotations/rotation_3/Spiekeroog_biogeo/week4/exp3/rate_plots/beach_above_mwl.jpeg",
plot =  plot_beach_above_mwl, width = 6, height = 4)
ggsave(filename = "/home/kai/Desktop/grad_school/marmic/lab_rotations/rotation_3/Spiekeroog_biogeo/week4/exp3/rate_plots/lagoon.jpeg",
plot =  plot_lagoon, width = 6, height = 4)
ggsave(filename = "/home/kai/Desktop/grad_school/marmic/lab_rotations/rotation_3/Spiekeroog_biogeo/week4/exp3/rate_plots/berm.jpeg",
plot =  plot_berm, width = 6, height = 4)
ggsave(filename = "/home/kai/Desktop/grad_school/marmic/lab_rotations/rotation_3/Spiekeroog_biogeo/week4/exp3/rate_plots/low_water_line.jpeg",
plot =  plot_low_water_line, width = 6, height = 4)
multiplot <- function(..., plotlist=NULL, file, cols=2, layout= matrix(c(1,2,3,4,0,0), nrow=3, byrow=TRUE)) {
require(grid)
# Make a list from the ... arguments and plotlist
plots <- c(list(...), plotlist)
numPlots = length(plots)
# If layout is NULL, then use 'cols' to determine layout
if (is.null(layout)) {
# Make the panel
# ncol: Number of columns of plots
# nrow: Number of rows needed, calculated from # of cols
layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
ncol = cols, nrow = ceiling(numPlots/cols))
}
if (numPlots==1) {
print(plots[[1]])
} else {
# Set up the page
grid.newpage()
pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
# Make each plot, in the correct location
for (i in 1:numPlots) {
# Get the i,j matrix positions of the regions that contain this subplot
matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
layout.pos.col = matchidx$col))
}
}
}
mult_plot <- multiplot(plot_beach_above_mwl,plot_lagoon,plot_berm,plot_low_water_line, cols=2)
setwd("/home/kai/Desktop/grad_school/marmic/lab_rotations/rotation_3/Spiekeroog_biogeo/week4/exp4/r_script_data")
mydata = read.csv("exp_4_data.csv")
mydata <- mutate(mydata, time.hours = time.minutes / 60)
names(mydata)
head(select(mydata, time.minutes,depth))
head(mydata)
min(select(mydata, oxygen))
station2 <- filter(mydata, station==2)
station4 <- filter(mydata, station==4)
station5 <- filter(mydata, station==5)
station6 <- filter(mydata, station==6)
station8 <- filter(mydata, station==8)
plot_station_2<- station2 %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(se = FALSE, method = "lm") +
ggtitle("Station 2") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#ecd240", "#ff8811", "#f12700", "#972e23"))
plot_station_4<- station4 %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(se = FALSE, method = "lm") +
ggtitle("Station 4") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#ecd240", "#ff8811", "#f12700", "#972e23"))
plot_station_5<- station5 %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(se = FALSE, method = "lm") +
ggtitle("Station 5") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#ecd240", "#ff8811", "#f12700", "#972e23"))
plot_station_6<- station6 %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(se = FALSE, method = "lm") +
ggtitle("Station 6") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#ecd240", "#ff8811", "#f12700", "#972e23"))
plot_station_8<- station8 %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(se = FALSE, method = "lm") +
ggtitle("Station 8") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#c0e105", "#ecd240", "#ff8811", "#f12700", "#972e23"))
plot_station_8
plot_station_8<- station8 %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(se = FALSE, method = "lm") +
ggtitle("Station 8") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#fbff4e", "#ecd240", "#ff8811", "#f12700", "#972e23"))
plot_station_8
plot_station_8<- station8 %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(se = FALSE, method = "lm") +
ggtitle("Station 8") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#f9ff08", "#ecd240", "#ff8811", "#f12700", "#972e23"))
plot_station_8
plot_station_8<- station8 %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(se = FALSE, method = "lm") +
ggtitle("Station 8") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#f9ff00", "#ecd240", "#ff8811", "#f12700", "#972e23"))
plot_station_8
plot_station_8<- station8 %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(se = FALSE, method = "lm") +
ggtitle("Station 8") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#f2ff00", "#ecd240", "#ff8811", "#f12700", "#972e23"))
plot_station_8
plot_station_8<- station8 %>%
ggplot(aes(time.hours, oxygen, colour = depth)) +
geom_point(size=1, stroke=1.2 ) +
theme_light() +
scale_x_continuous("Time (h)") +
scale_y_continuous(expression(paste("Oxygen (μmol l"^"-1" *")" )), limits = c(0, 250)) +
geom_smooth(se = FALSE, method = "lm") +
ggtitle("Station 8") + theme(plot.title = element_text(hjust = 0.5)) +
labs(colour ="Depth") + scale_colour_manual(values = c("#f0fd00", "#ecd240", "#ff8811", "#f12700", "#972e23"))
plot_station_8
plot(plot_station_2)
plot(plot_station_4)
plot(plot_station_5)
plot(plot_station_6)
plot(plot_station_8)
ggsave(filename = "/home/kai/Desktop/grad_school/marmic/lab_rotations/rotation_3/Spiekeroog_biogeo/week4/exp4/r_script_data/rate_plots/2.jpeg",
plot =  plot_station_2, width = 6, height = 4)
ggsave(filename = "/home/kai/Desktop/grad_school/marmic/lab_rotations/rotation_3/Spiekeroog_biogeo/week4/exp4/r_script_data/rate_plots/4.jpeg",
plot =  plot_station_4, width = 6, height = 4)
ggsave(filename = "/home/kai/Desktop/grad_school/marmic/lab_rotations/rotation_3/Spiekeroog_biogeo/week4/exp4/r_script_data/rate_plots/5.jpeg",
plot =  plot_station_5, width = 6, height = 4)
ggsave(filename = "/home/kai/Desktop/grad_school/marmic/lab_rotations/rotation_3/Spiekeroog_biogeo/week4/exp4/r_script_data/rate_plots/6.jpeg",
plot =  plot_station_6, width = 6, height = 4)
ggsave(filename = "/home/kai/Desktop/grad_school/marmic/lab_rotations/rotation_3/Spiekeroog_biogeo/week4/exp4/r_script_data/rate_plots/8.jpeg",
plot =  plot_station_8, width = 6, height = 4)
multiplot <- function(..., plotlist=NULL, file, cols=2, layout= matrix(c(1,2,3,4,5,0), nrow=3, byrow=TRUE)) {
require(grid)
# Make a list from the ... arguments and plotlist
plots <- c(list(...), plotlist)
numPlots = length(plots)
# If layout is NULL, then use 'cols' to determine layout
if (is.null(layout)) {
# Make the panel
# ncol: Number of columns of plots
# nrow: Number of rows needed, calculated from # of cols
layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
ncol = cols, nrow = ceiling(numPlots/cols))
}
if (numPlots==1) {
print(plots[[1]])
} else {
# Set up the page
grid.newpage()
pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
# Make each plot, in the correct location
for (i in 1:numPlots) {
# Get the i,j matrix positions of the regions that contain this subplot
matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
layout.pos.col = matchidx$col))
}
}
}
mult_plot <- multiplot(plot_station_2, plot_station_4, plot_station_5, plot_station_6, plot_station_8, cols=2)
library(ggplot2)
library(gstat)
library(sp)
library(maptools)
library(dplyr)
library(tidyr)
setwd("/home/kai/Desktop/grad_school/marmic/lab_rotations/rotation_3/Spiekeroog_biogeo/week5/GMT_figure/march_oxygen_profile")
march_oxygen_profile <- read.csv(file = "march_oxygen_profile.csv",header = TRUE)
march_oxygen_profile_test <- march_oxygen_profile #may not need to duplicate
min_x <- min(march_oxygen_profile_test$x)
max_x <- max(march_oxygen_profile_test$x) - min_x
march_oxygen_profile  <- march_oxygen_profile %>% mutate(x= x - min_x )
march_oxygen_profile_test <- mutate(march_oxygen_profile_test, x= x-min_x )
min_x <- 0
min_y <- min(march_oxygen_profile_test$y) - 0.1
max_y <- max(march_oxygen_profile_test$y) + 0.1
top <- filter(march_oxygen_profile_test, depth ==10)
loess_top <- loess(y ~ x, data = select(top, x, y))
bottom <- filter(march_oxygen_profile_test, depth ==100)
loess_bottom <- loess(y ~ x, data = select(bottom, x, y))
march_oxygen_profile_test <- drop_na(march_oxygen_profile_test)
march_oxygen_profile_test
View(march_oxygen_profile_test)
march_oxygen_profile <- read.csv(file = "march_oxygen_profile.csv",header = TRUE)
march_oxygen_profile_test <- march_oxygen_profile #may not need to duplicate
setwd("/home/kai/Desktop/grad_school/marmic/lab_rotations/rotation_3/Spiekeroog_biogeo/week5/GMT_figure/march_oxygen_profile")
march_oxygen_profile <- read.csv(file = "march_oxygen_profile.csv",header = TRUE)
march_oxygen_profile_test <- march_oxygen_profile #may not need to duplicate
min_x <- min(march_oxygen_profile_test$x)
max_x <- max(march_oxygen_profile_test$x) - min_x
march_oxygen_profile  <- march_oxygen_profile %>% mutate(x= x - min_x )
march_oxygen_profile_test <- mutate(march_oxygen_profile_test, x= x-min_x )
min_x <- 0
min_y <- min(march_oxygen_profile_test$y) - 0.1
max_y <- max(march_oxygen_profile_test$y) + 0.1
top <- filter(march_oxygen_profile_test, depth ==10)
loess_top <- loess(y ~ x, data = select(top, x, y))
bottom <- filter(march_oxygen_profile_test, depth ==100)
loess_bottom <- loess(y ~ x, data = select(bottom, x, y))
march_oxygen_profile_test <- drop_na(march_oxygen_profile_test)
x.range <- as.numeric(c(min_x, max_x))  # min/max longitude of the interpolation area
y.range <- as.numeric(c(min_y, max_y))  # min/max latitude of the interpolation area
grd <- expand.grid(x = seq(from = x.range[1], to = x.range[2], by = 0.02),
y = seq(from = y.range[1], to = y.range[2], by = 0.00124))
coordinates(grd) <- ~x + y
gridded(grd) <- TRUE
coordinates(march_oxygen_profile_test) = ~x + y
idw <- idw(formula = oxygen ~ 1, locations = march_oxygen_profile_test,
newdata = grd)  # apply idw model for the data
idw.output = as.data.frame(idw)  # output is defined as a data table
View(idw.output)
??idw
idw <- idw(formula = oxygen ~ 1, locations = march_oxygen_profile_test,
newdata = grd, model = "Exp")  # apply idw model for the data
march_oxygen_profile_test
krige0 <- krige0(formula = oxygen ~ 1, data = march_oxygen_profile_test,
newdata = grd, model = "Exp")
krige0 <- krige0(formula = oxygen ~ 1, data = march_oxygen_profile_test,
newdata = grd, model = Exp)
?krige0
krige0 <- krige0(formula = oxygen ~ 1, data = march_oxygen_profile_test,
newdata = grd, model = vgm("Sph"))
